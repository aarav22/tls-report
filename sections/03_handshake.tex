For consistency with the notation, we let P play the role of the client and Q play the role of the server. P and Q wish to setup a secure session. 

\textbf{TLS 1.3} supports both one-sided and mutual authentication. In most cases, authentication for the client is optional. In the notation, $(E_s , D_s)$ is a symmetric encryption scheme that provides authenticated encryption, such as AES-128 in GCM mode.  Algorithm $S$ refers to a MAC signing algorithm, such as HMAC-SHA256. Algorithms $Sig_P(\cdot )$ and $Sig_Q(\cdot )$ sign the provided data using P's or Q's signing keys. Finally, the hash functions $H_1, H_2$ are used to derive symmetric keys. They are built from HKDF (Apppendix I) with hash functions such as SHA-256. The notations are taken from \cite{gradcourse}.

The cipher-suites which determine the symmetric encryption scheme, the hash function in the MAC signing algorithm and HKDF are negotiated during the handshake. The cipher-suites are defined in \cite{rfc8446}. They are specified in Table \ref{tab:ciphersuites}. 

% TLS uses \textbf{Authenticated encryption} \cite{ae} that is a form of encryption that, in addition to providing confidentiality for the plaintext that is encrypted, provides a way to check its integrity and authenticity. \textbf{Authenticated Encryption with Associated Data (AEAD)} \cite{aead}, adds the ability to check the integrity and authenticity of some Associated Data (AD), also called "additional authenticated data", that is not encrypted.

% Many applications use an encryption method and a MAC together to provide both of those security services, with each algorithm using an independent key. More recently, the idea of providing both security services using a single cryptoalgorithm has become accepted \cite{rfc5116}. In this concept, the cipher and MAC are replaced by an Authenticated Encryption with Associated Data (AEAD) algorithm \cite{aead}.




\begin{table}[ht]
  \centering
  \begin{tabular}{|l|l|}
    \hline Description & Value \\
    \hline 
    TLS\_AES\_128\_GCM\_SHA256 & $\{0\times13,0\times01\}$ \\
    \hline TLS\_AES\_256\_GCM\_SHA384 & $\{0\times13,0\times02\}$ \\
    \hline TLS\_CHACHA20\_POLY1305\_SHA256 & $\{0\times13,0\times03\}$ \\
    \hline TLS\_AES\_128\_CCM\_SHA256 & $\{0\times13,0\times04\}$ \\
    \hline TLS\_AES\_128\_CCM\_8\_SHA256 & $\{0\times13,0\times05\}$ \\
    \hline
  \end{tabular}
  \caption{Cipher-Suites \cite{rfc8446}. Cipher suite names follow the naming convention: CipherSuite TLS\_AEAD\_HASH = VALUE;}
  \label{tab:ciphersuites}
\end{table}



\textbf{The protocol.} The handshake protocol 
% \begin{align*}
%     & \textbf { ClientHello } \\
%     & u:=g^\alpha, \mathcal{N}_{\mathrm{c}}, offer \\
%     & \textbf { ServerHello } \\
%     & v:=g^\beta, \mathcal{N}_{\mathrm{s}}, \text { mode } \\ 
%     & c_1:=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, \text { CertReqest }\right) \\ 
%     & c_2:=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, \operatorname{Cert}_Q\right) \\ 
%     & c_3:=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, \text { Sig }\right. \\ 
%     & \left.c_4\left(u, \mathcal{N}_{\mathrm{c}}, \text { offer }, v, \mathfrak{N}_{\mathrm{s}}, \text { mode }, c_1, c_2\right)\right) \\ 
%     & c_4=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, S\left(k_{\mathrm{sm}},\left(u, \mathfrak{N}_{\mathrm{c}}, \text { offer }, v, \mathfrak{N}_{\mathrm{s}}, \text { mode }, c_1, c_2, c_3\right)\right)\right) \\
%     & \left(k_{\mathrm{sh}}, k_{\mathrm{sm}}, k_{\mathrm{ch}}, k_{\mathrm{cm}}\right):=H_1\left(g^{\alpha \beta}, u, \mathcal{N}_{\mathrm{c}}, \text { offer }, v, \mathcal{N}_{\mathrm{s}}, \text { mode }\right) \\
%     & \left(k_{\mathrm{c} \rightarrow \mathrm{s}}, k_{\mathrm{s} \rightarrow \mathrm{c}}\right):=H_2\left(g^{\alpha \beta}, u, \mathcal{N}_{\mathrm{c}}, \text { offer, } v, \mathfrak{N}_{\mathrm{s}}, \text { mode }, c_1, \ldots, c_4\right) \\
%     & \text { ClientKeyExchange } \\
% \end{align*}

% \begin{figure}[ht]
%     \centering
%     \begin{tikzpicture}[block/.style={draw,minimum width=2cm,minimum height=1cm}, font=\sffamily] 
%     \node[block](C) {Client}; 
%     \node[block,right=9cm of C](S) {Server}; 
%     \draw[-latex] (C.15) -- (S.165)
%     node[midway,above]{Request(GET,POST,PUT,DELETE,HEAD,OPTION)}; 
%     \draw[-latex] (S.195) -- (C.-15) node[midway,above]{
%       $\begin{aligned}
%         & \textbf { ServerHello } \\
%         & v:=g^\beta, \mathcal{N}_{\mathrm{s}}, \text { mode } \\ 
%         & c_1:=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, \text { CertReqest }\right) \\ 
%         & c_2:=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, \operatorname{Cert}_Q\right) \\ 
%         & c_3:=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, \text { Sig }\right. \\ 
%         & \left.c_4\left(u, \mathcal{N}_{\mathrm{c}}, \text { offer }, v, \mathfrak{N}_{\mathrm{s}}, \text { mode }, c_1, c_2\right)\right) \\ 
%         & c_4=E_{\mathrm{s}}\left(k_{\mathrm{sh}}, S\left(k_{\mathrm{sm}},\left(u, \mathfrak{N}_{\mathrm{c}}, \text { offer }, v, \mathfrak{N}_{\mathrm{s}}, \text { mode }, c_1, c_2, c_3\right)\right)\right) \\
%         & \left(k_{\mathrm{sh}}, k_{\mathrm{sm}}, k_{\mathrm{ch}}, k_{\mathrm{cm}}\right):=H_1\left(g^{\alpha \beta}, u, \mathcal{N}_{\mathrm{c}}, \text { offer }, v, \mathcal{N}_{\mathrm{s}}, \text { mode }\right) \\
%         & \left(k_{\mathrm{c} \rightarrow \mathrm{s}}, k_{\mathrm{s} \rightarrow \mathrm{c}}\right):=H_2\left(g^{\alpha \beta}, u, \mathcal{N}_{\mathrm{c}}, \text { offer, } v, \mathfrak{N}_{\mathrm{s}}, \text { mode }, c_1, \ldots, c_4\right) \\
%       \end{aligned}$
%     }; 
%     \end{tikzpicture}
%     \caption{TLS Handshake Sequence}
%     \label{fig:handshake}
%   \end{figure}